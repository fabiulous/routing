(function(l,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],a):(l=typeof globalThis<"u"?globalThis:l||self,a(l.routing={},l.React))})(this,function(l,a){"use strict";const q=(e,r)=>{const t=p(e,r);return a.createContext({router:t,location:{pathname:window.location.pathname,search:"",hash:""},go:(c,s)=>e(window.location.pathname,c,s)})},Q=e=>()=>{const{router:r}=a.useContext(e);return r};var B=function(e){a.useEffect(e,[])};const L=B;var V=function(e){L(function(){e()})};const b=V,O="%[a-f0-9]{2}",x=new RegExp("("+O+")|([^%]+?)","gi"),w=new RegExp("("+O+")+","gi");function y(e,r){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;r=r||1;const t=e.slice(0,r),n=e.slice(r);return Array.prototype.concat.call([],y(t),y(n))}function _(e){try{return decodeURIComponent(e)}catch{let r=e.match(x)||[];for(let t=1;t<r.length;t++)e=y(r,t).join(""),r=e.match(x)||[];return e}}function H(e){const r={"%FE%FF":"��","%FF%FE":"��"};let t=w.exec(e);for(;t;){try{r[t[0]]=decodeURIComponent(t[0])}catch{const c=_(t[0]);c!==t[0]&&(r[t[0]]=c)}t=w.exec(e)}r["%C2"]="�";const n=Object.keys(r);for(const c of n)e=e.replace(new RegExp(c,"g"),r[c]);return e}function P(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return H(e)}}function C(e,r){if(!(typeof e=="string"&&typeof r=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e===""||r==="")return[];const t=e.indexOf(r);return t===-1?[]:[e.slice(0,t),e.slice(t+r.length)]}function K(e,r){const t={};if(Array.isArray(r))for(const n of r){const c=Object.getOwnPropertyDescriptor(e,n);c!=null&&c.enumerable&&Object.defineProperty(t,n,c)}else for(const n of Reflect.ownKeys(e)){const c=Object.getOwnPropertyDescriptor(e,n);if(c.enumerable){const s=e[n];r(n,s,e)&&Object.defineProperty(t,n,c)}}return t}const k=e=>e==null,z=e=>encodeURIComponent(e).replace(/[!'()*]/g,r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`),m=Symbol("encodeFragmentIdentifier");function G(e){switch(e.arrayFormat){case"index":return r=>(t,n)=>{const c=t.length;return n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?t:n===null?[...t,[i(r,e),"[",c,"]"].join("")]:[...t,[i(r,e),"[",i(c,e),"]=",i(n,e)].join("")]};case"bracket":return r=>(t,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?t:n===null?[...t,[i(r,e),"[]"].join("")]:[...t,[i(r,e),"[]=",i(n,e)].join("")];case"colon-list-separator":return r=>(t,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?t:n===null?[...t,[i(r,e),":list="].join("")]:[...t,[i(r,e),":list=",i(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const r=e.arrayFormat==="bracket-separator"?"[]=":"=";return t=>(n,c)=>c===void 0||e.skipNull&&c===null||e.skipEmptyString&&c===""?n:(c=c===null?"":c,n.length===0?[[i(t,e),r,i(c,e)].join("")]:[[n,i(c,e)].join(e.arrayFormatSeparator)])}default:return r=>(t,n)=>n===void 0||e.skipNull&&n===null||e.skipEmptyString&&n===""?t:n===null?[...t,i(r,e)]:[...t,[i(r,e),"=",i(n,e)].join("")]}}function J(e){let r;switch(e.arrayFormat){case"index":return(t,n,c)=>{if(r=/\[(\d*)]$/.exec(t),t=t.replace(/\[\d*]$/,""),!r){c[t]=n;return}c[t]===void 0&&(c[t]={}),c[t][r[1]]=n};case"bracket":return(t,n,c)=>{if(r=/(\[])$/.exec(t),t=t.replace(/\[]$/,""),!r){c[t]=n;return}if(c[t]===void 0){c[t]=[n];return}c[t]=[...c[t],n]};case"colon-list-separator":return(t,n,c)=>{if(r=/(:list)$/.exec(t),t=t.replace(/:list$/,""),!r){c[t]=n;return}if(c[t]===void 0){c[t]=[n];return}c[t]=[...c[t],n]};case"comma":case"separator":return(t,n,c)=>{const s=typeof n=="string"&&n.includes(e.arrayFormatSeparator),f=typeof n=="string"&&!s&&d(n,e).includes(e.arrayFormatSeparator);n=f?d(n,e):n;const o=s||f?n.split(e.arrayFormatSeparator).map(u=>d(u,e)):n===null?n:d(n,e);c[t]=o};case"bracket-separator":return(t,n,c)=>{const s=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!s){c[t]=n&&d(n,e);return}const f=n===null?[]:n.split(e.arrayFormatSeparator).map(o=>d(o,e));if(c[t]===void 0){c[t]=f;return}c[t]=[...c[t],...f]};default:return(t,n,c)=>{if(c[t]===void 0){c[t]=n;return}c[t]=[...[c[t]].flat(),n]}}}function $(e){if(typeof e!="string"||e.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function i(e,r){return r.encode?r.strict?z(e):encodeURIComponent(e):e}function d(e,r){return r.decode?P(e):e}function j(e){return Array.isArray(e)?e.sort():typeof e=="object"?j(Object.keys(e)).sort((r,t)=>Number(r)-Number(t)).map(r=>e[r]):e}function E(e){const r=e.indexOf("#");return r!==-1&&(e=e.slice(0,r)),e}function W(e){let r="";const t=e.indexOf("#");return t!==-1&&(r=e.slice(t)),r}function A(e,r){return r.parseNumbers&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?e=Number(e):r.parseBooleans&&e!==null&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&(e=e.toLowerCase()==="true"),e}function h(e){e=E(e);const r=e.indexOf("?");return r===-1?"":e.slice(r+1)}function F(e,r){r={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...r},$(r.arrayFormatSeparator);const t=J(r),n=Object.create(null);if(typeof e!="string"||(e=e.trim().replace(/^[?#&]/,""),!e))return n;for(const c of e.split("&")){if(c==="")continue;const s=r.decode?c.replace(/\+/g," "):c;let[f,o]=C(s,"=");f===void 0&&(f=s),o=o===void 0?null:["comma","separator","bracket-separator"].includes(r.arrayFormat)?o:d(o,r),t(d(f,r),o,n)}for(const[c,s]of Object.entries(n))if(typeof s=="object"&&s!==null)for(const[f,o]of Object.entries(s))s[f]=A(o,r);else n[c]=A(s,r);return r.sort===!1?n:(r.sort===!0?Object.keys(n).sort():Object.keys(n).sort(r.sort)).reduce((c,s)=>{const f=n[s];return f&&typeof f=="object"&&!Array.isArray(f)?c[s]=j(f):c[s]=f,c},Object.create(null))}function N(e,r){if(!e)return"";r={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...r},$(r.arrayFormatSeparator);const t=f=>r.skipNull&&k(e[f])||r.skipEmptyString&&e[f]==="",n=G(r),c={};for(const[f,o]of Object.entries(e))t(f)||(c[f]=o);const s=Object.keys(c);return r.sort!==!1&&s.sort(r.sort),s.map(f=>{const o=e[f];return o===void 0?"":o===null?i(f,r):Array.isArray(o)?o.length===0&&r.arrayFormat==="bracket-separator"?i(f,r)+"[]":o.reduce(n(f),[]).join("&"):i(f,r)+"="+i(o,r)}).filter(f=>f.length>0).join("&")}function U(e,r){var c;r={decode:!0,...r};let[t,n]=C(e,"#");return t===void 0&&(t=e),{url:((c=t==null?void 0:t.split("?"))==null?void 0:c[0])??"",query:F(h(e),r),...r&&r.parseFragmentIdentifier&&n?{fragmentIdentifier:d(n,r)}:{}}}function I(e,r){r={encode:!0,strict:!0,[m]:!0,...r};const t=E(e.url).split("?")[0]||"",n=h(e.url),c={...F(n,{sort:!1}),...e.query};let s=N(c,r);s&&(s=`?${s}`);let f=W(e.url);if(e.fragmentIdentifier){const o=new URL(t);o.hash=e.fragmentIdentifier,f=r[m]?o.hash:`#${e.fragmentIdentifier}`}return`${t}${s}${f}`}function R(e,r,t){t={parseFragmentIdentifier:!0,[m]:!1,...t};const{url:n,query:c,fragmentIdentifier:s}=U(e,t);return I({url:n,query:K(c,r),fragmentIdentifier:s},t)}function X(e,r,t){const n=Array.isArray(r)?c=>!r.includes(c):(c,s)=>!r(c,s);return R(e,n,t)}const Y=Object.freeze(Object.defineProperty({__proto__:null,exclude:X,extract:h,parse:F,parseUrl:U,pick:R,stringify:N,stringifyUrl:I},Symbol.toStringTag,{value:"Module"})),Z={arrayFormat:"bracket",parseBooleans:!0},D=e=>Y.parse(e,Z),v=e=>(r,t)=>{const{go:n,location:c}=a.useContext(e),s=a.useMemo(()=>c?D(c.search)[r]:void 0,[c,r]),f=a.useCallback(o=>{n({[r]:o})},[n,r]);return b(()=>{!s&&t&&n({[r]:t},!0)}),[s,f]},ee=e=>(r,t,n=500)=>{const{go:c,location:s}=a.useContext(e),f=a.useRef(),o=a.useMemo(()=>{const S=s?D(s.search)[r]:void 0;return Array.isArray(S)?S[0]:S},[s,r]),[u,g]=a.useState(o),T=a.useCallback(()=>{c({[r]:u})},[c,r,u]);return a.useEffect(()=>(o!==u&&(f.current=window.setTimeout(()=>{T()},n)),()=>{window.clearTimeout(f.current)}),[T,n,o,u]),a.useEffect(()=>{g(o)},[o]),b(()=>{!u&&t&&(c({[r]:t},!0),g(t))}),[u,o,g]},M=(e,r,t="")=>{if(typeof r=="string"){const c=`${t}${r}`;return{path:c,go:(s,f=!1)=>e(c,s,f)}}if(typeof r=="function")return c=>{const s=r(c);if(typeof s=="string"){const o=`${t}${s}`;return{path:o,go:(u,g=!1)=>e(o,u,g)}}const f=`${t}${s.path}`;return{path:f,go:(o,u=!1)=>e(f,o,u),...p(e,s.routes,f)}};const n=`${t}${r.path}`;return{path:n,go:(c,s=!1)=>e(n,c,s),...Object.keys(r.routes).reduce((c,s)=>({...c,[s]:M(e,r.routes[s],n)}),{})}},p=(e,r,t="")=>Object.keys(r).reduce((n,c)=>({...n,[c]:M(e,r[c],t)}),{}),re=(e,r)=>{const t=q(e,r),n=Q(t),c=v(t),s=ee(t);return{RoutingContext:t,useRouter:n,useQueryState:c,useDebouncedQueryState:s}};l.generateRoutes=p,l.generateRouting=re,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
